---
title: "Algorithm of Priority Queue(Heap)"
date: 2021-11-29
tags:
 - algorithm
categories:
 - Algorithm
---

 ğŸŸ¥ğŸŸ§ğŸŸ¨ ä¼˜å…ˆçº§é˜Ÿåˆ—çš„åŸç†ä»¥åŠåº”ç”¨ã€‚ğŸŸ©ğŸŸªğŸŸ«ğŸŸ¨

1. å¤§æ ¹å †
2. å°æ ¹å †ï¼ˆPython é»˜è®¤ï¼‰

<!-- more -->

## å¤§æ ¹å †ä¸å°æ ¹å †

### å¤§æ ¹å †

ä»€ä¹ˆæ˜¯å¤§æ ¹å †ï¼Ÿ

### å°æ ¹å †

ä»€ä¹ˆæ˜¯å°æ ¹å †ï¼ŸPython é»˜è®¤æ˜¯å°æ ¹å †ã€‚

```python
a = [1, 3, 2, -1, 0]
heapq.heapify(a)
heapq.heappop(a) # -1
```

## ä¼˜å…ˆçº§é˜Ÿåˆ—

### åŸç†ä¸å®ç°

ğŸ§¡ğŸ’›ğŸ’š åœ¨ Python ä¸­ï¼Œä½¿ç”¨å †(heapq)æ¥å®ç°ä¼˜å…ˆçº§é˜Ÿåˆ—ã€‚

- åˆå§‹åŒ–æ—¶ï¼Œç›´æ¥å°†ä¼˜å…ˆçº§é˜Ÿåˆ—åˆå§‹åŒ–ä¸ºåˆ—è¡¨ï¼š`heap = []`;
- python ä½¿ç”¨å †çš„æ—¶å€™ï¼Œ**é»˜è®¤æ˜¯å°æ ¹å †**ã€‚



### LC786 ç¬¬ K ä¸ªæœ€å°çš„ç´ æ•°åˆ†æ•°

#### [786. ç¬¬ K ä¸ªæœ€å°çš„ç´ æ•°åˆ†æ•°](https://leetcode-cn.com/problems/k-th-smallest-prime-fraction/)

> ç»™ä½ ä¸€ä¸ªæŒ‰é€’å¢é¡ºåºæ’åºçš„æ•°ç»„ arr å’Œä¸€ä¸ªæ•´æ•° k ã€‚æ•°ç»„ arr ç”± 1 å’Œè‹¥å¹² ç´ æ•°  ç»„æˆï¼Œä¸”å…¶ä¸­æ‰€æœ‰æ•´æ•°äº’ä¸ç›¸åŒã€‚
>
> å¯¹äºæ¯å¯¹æ»¡è¶³ 0 < i < j < arr.length çš„ i å’Œ j ï¼Œå¯ä»¥å¾—åˆ°åˆ†æ•° arr[i] / arr[j] ã€‚
>
> é‚£ä¹ˆç¬¬ k ä¸ªæœ€å°çš„åˆ†æ•°æ˜¯å¤šå°‘å‘¢?  ä»¥é•¿åº¦ä¸º 2 çš„æ•´æ•°æ•°ç»„è¿”å›ä½ çš„ç­”æ¡ˆ, è¿™é‡Œ answer[0] == arr[i] ä¸” answer[1] == arr[j] ã€‚
>
> arr = [1,2,3,5], k = 3
> 
> è¾“å‡ºï¼š[2,5]

é‡åˆ°ç¬¬ k å¤§ã€ç¬¬ k å°çš„é—®é¢˜ï¼Œæˆ‘ä»¬é€šå¸¸çš„æ€è·¯å°±æ˜¯ä½¿ç”¨ä¼˜å…ˆçº§é˜Ÿåˆ—æ¥å®ç°ã€‚

è¯¥é—®é¢˜çš„å®ç°ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š

```python
class Solution:
    def kthSmallestPrimeFraction(self, arr: List[int], k: int) -> List[int]:
        heap = []

        # é»˜è®¤å°æ ¹å †
        n = len(arr)
        # å…ˆæŠŠæœ€å°çš„é‚£å †æ•°å…¥å †
        for i in range(1, n):
            heapq.heappush(heap, (arr[0] / arr[i], 0, i))
        i, j = 0, 0
        # why k
        for _ in range(k):
            val, i, j = heapq.heappop(heap)
            if i + 1 < j:
                heapq.heappush(heap, (arr[i + 1] / arr[j], i + 1, j))
        # why not heap
        return [arr[i], arr[j]]
```

è¿™ä¸ªä»£ç å®ç°ä¸­ï¼Œæœ‰å¾ˆå¤šéœ€è¦æ³¨æ„çš„ç»†èŠ‚ï¼š

1. è®°ä½ Python é»˜è®¤çš„æ˜¯å°æ ¹å †ï¼›
2. æˆ‘ä»¬åœ¨ `for` å¾ªç¯ä¸­å¾ªç¯äº† `k` æ¬¡ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬ä¼šå¾ªç¯ `k-1`æ¬¡ï¼›è¿™ä¸ªç»†èŠ‚éœ€è¦ç•™æ„ï¼Œåç»­é€šè¿‡æ¯”è¾ƒä¸åŒçš„é¢˜è§£å¯¹å½’ç±»è¿›è¡Œæ€»ç»“ï¼›
3. æˆ‘ä»¬æŠŠæœ€å°çš„åˆ†æ•°ï¼ˆåˆ†å­ä¸º 1ï¼Œåˆ†æ¯ä¸ºæ‰€æœ‰æ•°æ„æˆçš„å°æ ¹å †çš„å †é¡¶å…ƒç´ ï¼‰æ‹¿å‡ºæ¥ï¼Œç„¶åå°†æ¯”è¿™ä¸ªå…ƒç´ å¤§çš„å…ƒç´ æ”¾è¿›å †ï¼ˆç›®çš„æ˜¯ä¸ºäº†æ¯”è¾ƒæ”¾è¿›å †çš„å…ƒç´ å’ŒåŸæœ‰å †ä¸­çš„å…ƒç´ çš„å¤§å°ï¼‰ï¼Œè€ŒåæŒ‰ç…§é¡ºåºå‡ºå †ï¼Œåˆ°ç¬¬ k ä¸ªå³ä¸ºæˆ‘ä»¬éœ€è¦çš„å…ƒç´ ã€‚



### LC215 æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´ 

#### [æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´ ](https://leetcode-cn.com/problems/kth-largest-element-in-an-array/)

> ç»™å®šæ•´æ•°æ•°ç»„ `nums` å’Œæ•´æ•° `k`ï¼Œè¯·è¿”å›æ•°ç»„ä¸­ç¬¬ `**k**` ä¸ªæœ€å¤§çš„å…ƒç´ ã€‚
>
> è¯·æ³¨æ„ï¼Œä½ éœ€è¦æ‰¾çš„æ˜¯æ•°ç»„æ’åºåçš„ç¬¬ `k` ä¸ªæœ€å¤§çš„å…ƒç´ ï¼Œè€Œä¸æ˜¯ç¬¬ `k` ä¸ªä¸åŒçš„å…ƒç´ ã€‚
>
> è¾“å…¥: [3,2,1,5,6,4] å’Œ k = 2
>
> è¾“å‡º: 5

#### å°æ ¹å †æ±‚è§£

è¿™ä¹Ÿæ˜¯ä¸€ä¸ªåº”ç”¨å°æ ¹å †æ±‚è§£çš„é—®é¢˜ï¼Œå…¶å®ç°ä»£ç å¦‚ä¸‹ï¼š

```python
class Solution:
    def findKthLargest(self, nums: List[int], k: int) -> int:
        heap = [x for x in nums[:k]]
        heapq.heapify(heap)
        for i in range(k, len(nums)):
            if nums[i] > heap[0]:
                heapq.heappop(heap)
                heapq.heappush(heap, nums[i])
        return heap[0]
```

ä»ä¸Šæ®µä»£ç ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼š

1. åœ¨å»ºç«‹å°æ ¹å †çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç›´æ¥å–äº†æ•°ç»„çš„å‰ k ä¸ªå…ƒç´ ï¼Œç”¨äºå»ºå †ï¼Œå¦‚æ­¤ä¸€æ¥æˆ‘ä»¬å¯ä»¥ä»æ•°ç»„çš„å‰©ä½™å…ƒç´ ä¸­ä¸€ä¸ªä¸€ä¸ªæ·»åŠ å…ƒç´ ï¼Œæ¯å¢åŠ ä¸€ä¸ªå…ƒç´ ï¼Œå †é¡¶æœ€å°çš„å…ƒç´ å°±å‡ºå †äº†ï¼Œç›´åˆ°æˆ‘ä»¬å°†åŸæ•°ç»„ä¸­æ‰€æœ‰çš„å…ƒç´ éƒ½å…¥å †äº†ï¼Œæœ€åç•™ä¸‹äº†å®¹é‡ä¸º k çš„å°æ ¹å †ï¼Œå †é¡¶çš„å…ƒç´ å°±æ˜¯ç¬¬ k å¤§çš„å…ƒç´ ï¼›
2. éœ€è¦æ³¨æ„ï¼Œæˆ‘ä»¬åœ¨æ˜¯å¦å‡ºå †çš„æ—¶å€™æœ‰ä¸€ä¸ªåˆ¤æ–­ï¼Œå³å¦‚æœå½“å‰çš„å…ƒç´ æ¯”å †é¡¶å…ƒç´ å¤§ï¼Œæˆ‘ä»¬å°±æŠŠå †é¡¶å…ƒç´ å‡ºæ¨ã€‚

#### å¤§æ ¹å †æ±‚è§£

é™¤äº†è¿™ç§å°æ ¹å †çš„è§£æ³•ä¹‹å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨å¤§æ ¹å †æ¥æ±‚è§£è¿™ä¸ªé—®é¢˜ï¼Œç”¨å¤§æ ¹å †æ±‚è§£çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªéœ€è¦å°†å † pop k æ¬¡ï¼Œå°±å¯ä»¥å¾—åˆ°ç¬¬ k å¤§çš„å…ƒç´ ã€‚

```python
class Solution:
    def findKthLargest(self, nums: List[int], k: int) -> int:
        heap = [-x for x in nums]
        heapq.heapify(heap)
        for _ in range(k - 1):
            heapq.heappop(heap)

        return -heap[0]
```

ä½†æ˜¯æˆ‘ä»¬å¾ˆå®¹æ˜“çœ‹å‡ºï¼Œè¿™ç§æ–¹æ³•å°†æ•´ä¸ªæ•°ç»„éƒ½ç”¨äºå»ºå †äº†ï¼Œå…¶æ€§èƒ½åŠ¿å¿…å—åˆ°å½±å“ï¼Œåœ¨æ­¤æ˜¯ä¸ºäº†å±•ç¤ºå¤§æ ¹å †æ±‚è§£è¿™ä¸ªé—®é¢˜çš„æ–¹æ³•ã€‚



### LC1439 æœ‰åºçŸ©é˜µä¸­çš„ç¬¬ k ä¸ªæœ€å°æ•°ç»„å’Œ

[æœ‰åºçŸ©é˜µä¸­çš„ç¬¬ k ä¸ªæœ€å°æ•°ç»„å’Œ](https://leetcode-cn.com/problems/find-the-kth-smallest-sum-of-a-matrix-with-sorted-rows/)

> ç»™ä½ ä¸€ä¸ª m * n çš„çŸ©é˜µ matï¼Œä»¥åŠä¸€ä¸ªæ•´æ•° k ï¼ŒçŸ©é˜µä¸­çš„æ¯ä¸€è¡Œéƒ½ä»¥éé€’å‡çš„é¡ºåºæ’åˆ—ã€‚
>
> ä½ å¯ä»¥ä»æ¯ä¸€è¡Œä¸­é€‰å‡º 1 ä¸ªå…ƒç´ å½¢æˆä¸€ä¸ªæ•°ç»„ã€‚è¿”å›æ‰€æœ‰å¯èƒ½æ•°ç»„ä¸­çš„ç¬¬ k ä¸ª æœ€å° æ•°ç»„å’Œã€‚
>
> è¾“å…¥ï¼šmat = [[1,3,11],[2,4,6]], k = 5
>
> è¾“å‡ºï¼š7
>
> è§£é‡Šï¼šä»æ¯ä¸€è¡Œä¸­é€‰å‡ºä¸€ä¸ªå…ƒç´ ï¼Œå‰ k ä¸ªå’Œæœ€å°çš„æ•°ç»„åˆ†åˆ«æ˜¯ï¼š
>
> [1,2], [1,4], [3,2], [3,4], [1,6]ã€‚å…¶ä¸­ç¬¬ 5 ä¸ªçš„å’Œæ˜¯ 7 ã€‚ 



#### æš´åŠ›æ±‚è§£

å¯¹äºè¿™ç§é¢˜ç›®ï¼Œæˆ‘ä»¬åº”å½“å…ˆæŒæ¡æš´åŠ›æ±‚è§£çš„æ€è·¯ï¼Œå†å¯¹å…¶è¿›è¡Œä¼˜åŒ–ã€‚

```python
class Solution:
    def kthSmallest(self, matrix: List[List[int]], k: int) -> int:
        h = matrix[0][:]
        for row in matrix[1:]:
            h = sorted([i + j for i in row for j in h])[:k]
        return h[k - 1]
```

è¿™ä¸ªæ–¹æ³•æ˜¯å¯ä»¥ AC çš„ï¼Œæˆ‘ä»¬ç°åœ¨åˆ†æä¸€ä¸‹ä¸ºä»€ä¹ˆè¿™ä¸ªæ–¹æ³•æ˜¯å¯è¡Œçš„ã€‚

æˆ‘ä»¬å°†æ‰€æœ‰çš„å¯èƒ½æ€§å…¨æ‹¿å‡ºæ¥ï¼Œç„¶åå–å‰ k ä¸ªï¼Œæœ€åå†æ‹¿å‡ºæ¥æˆ‘ä»¬æƒ³è¦çš„å…ƒç´ å³å¯ã€‚

ä¸»è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬æ¯ä¸€æ¬¡åœ¨ç”Ÿæˆ h çš„æ—¶å€™ï¼Œéƒ½åªæˆªå–äº†å‰ K ä¸ªå…ƒç´ ï¼Œè¿™æ˜¯å› ä¸ºåé¢çš„å…ƒç´ ä¸å†æœ‰ç«äº‰åŠ›ï¼ˆæ¯•ç«Ÿåé¢çš„è‚¯å®šä¸æ˜¯å‰ k å°çš„äº†ï¼‰ï¼ŒåŸºäºè¿™ä¸ªåŸåˆ™ï¼Œæˆ‘ä»¬æ¯æ¬¡éƒ½ç”Ÿæˆ k ä¸ªå…ƒç´ ï¼Œæœ€ç»ˆæŠŠçŸ©é˜µçš„æ¯ä¸€è¡Œéƒ½éå†è¿‡å»ï¼Œå¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„ç­”æ¡ˆã€‚

â“â“â“ why `h = matrix[0][:]`?

æ¯”è¾ƒç–‘æƒ‘ï¼Œè¿™é‡Œä¸ºä»€ä¹ˆè¦ä½¿ç”¨è¿™ä¸ªå‘¢ï¼Ÿä»”ç»†æ€è€ƒäº†ä¸€ä¸‹ï¼Œè¿™æ®µä»£ç çš„ç›®çš„æ˜¯æŠŠçŸ©é˜µçš„ç¬¬ä¸€è¡Œå…ƒç´ å¤åˆ¶ä¸‹æ¥ï¼Œç„¶åå†å’Œå‰©ä¸‹çš„æ¯ä¸€è¡Œå…ƒç´ åŠ èµ·æ¥ï¼Œè¿™æ ·ä¼šè®¡ç®—åˆ°æ‰€æœ‰çš„å’Œå—ï¼Ÿ**æˆ‘ä»¬å‘ç°æ˜¯å¯ä»¥çš„**ï¼šğŸ§¡ğŸ§¡ è¿™ä¸ªé—®é¢˜å¾ˆå·§å¦™çš„ç»™å‡ºäº†ä¸€ä¸ªç­”æ¡ˆï¼šå¦‚ä½•æ±‚è§£å¤šä¸ªæ•°ç»„ï¼Œæ¯ä¸€ä¸ªæ•°ç»„å„å–ä¸€ä¸ªæ•°å­—ç›¸åŠ ï¼Œæ‰€æœ‰å¯èƒ½çš„å’Œï¼Ÿ

ä¸¾ä¾‹æ¥è¯´ï¼Œç»™å®šäº†æ•°ç»„å¦‚ä¸‹ï¼š

```python
matrix = [
    [1, 4, 7, 10],
    [2, 3, 5, 9],
    [1, 1, 12, 13]
]
```

æˆ‘ä»¬è¦ä»è¿™ä¸ªæ•°ç»„çš„æ¯ä¸€è¡Œå…ƒç´ ä¸­å–ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚ä»ç¬¬ä¸€è¡Œä¸­å– `1`, ç¬¬äºŒè¡Œä¸­å– `2`, ç¬¬ä¸‰è¡Œä¸­å– `1`, è®¡ç®—ä¸‰è€…çš„å’Œä¸º $1 + 2+ 1 = 5$, ä»¥æ­¤ç±»æ¨ï¼Œæˆ‘ä»¬è®¡ç®—å‡ºæ‰€æœ‰å¯èƒ½çš„å’Œã€‚

æŒ‰ç…§ä»¥å‰çš„æ€è·¯ï¼Œæˆ‘ä»¬ä¼šå°†è¿™ä¸‰ä¸ªæ•°ç»„çš„æ‰€æœ‰çš„æ’åˆ—ç»„åˆè®¡ç®—å‡ºæ¥ï¼Œå†æ±‚å’Œï¼Œæ¯”å¦‚è¯´ä½¿ç”¨ python çš„ `itertools.product`:

```python
def get_all_combines(self, mat: List[List[int]]):
    res = set()
    for nums in itertools.product(*mat):
        res.add(sum(nums))

    return list(res)
```

æˆ‘ä»¬ä½¿ç”¨ `set`æ¥é˜²æ­¢ä¸å¿…è¦çš„é‡å¤ï¼Œå…ˆå¾—åˆ°æ‰€æœ‰çš„ç»„åˆï¼Œå†å¯¹å…¶è¿›è¡Œæ±‚å’Œï¼Œæ±‚å’Œåæ·»åŠ åˆ°åˆ—è¡¨ä¸­ä¿å­˜ï¼Œæœ€ç»ˆçš„ç»“æœä¸ºï¼š$[4, 5, 7, 8, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 31, 32]$ã€‚



å¦‚æœæˆ‘ä»¬ç”¨ä¸Šè¿°çš„æ–¹æ³•ï¼Œå¯ä»¥å†™å‡ºå¦‚ä¸‹ä»£ç å¾ˆç®€å•çš„æ±‚å‡ºï¼š 

```python
def get_all_combines2(self, mat: List[List[int]]):
    h = mat[0][:]

    for nums in mat[1:]:
        h = sorted([i + j for i in h for j in nums])

    return list(set(h))
```

å…¶å®è¿™ç§æ–¹æ³•ä¹Ÿæ²¡æœ‰é¿å…äº†é‡å¤ï¼Œä½†æ˜¯å¯ä»¥ä¸ç”Ÿæˆæ‰€æœ‰çš„ç»„åˆå¯èƒ½æ€§ï¼Œæå¤§å‡å°‘äº†å†…å­˜æ¶ˆè€—ï¼Œå€¼å¾—å­¦ä¹ å’Œç»†ç»†å“å‘³ï¼

### LC264 ä¸‘æ•°II

[264. ä¸‘æ•° II](https://leetcode-cn.com/problems/ugly-number-ii/)

> ç»™ä½ ä¸€ä¸ªæ•´æ•° `n` ï¼Œè¯·ä½ æ‰¾å‡ºå¹¶è¿”å›ç¬¬ `n` ä¸ª **ä¸‘æ•°** ã€‚
>
> **ä¸‘æ•°** å°±æ˜¯åªåŒ…å«è´¨å› æ•° `2`ã€`3` å’Œ/æˆ– `5` çš„æ­£æ•´æ•°ã€‚

è¿™é“é¢˜ç›®å¦‚ä½•ä¸ä¼˜å…ˆçº§é˜Ÿåˆ—è”ç³»ä¸Šå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥å»ºç«‹ä¸€ä¸ªå¤§å°ä¸º n çš„å †ï¼Œç„¶ååˆ†åˆ«æŠŠç¬¦åˆè¦æ±‚çš„æ•°å…¥å †ï¼Œæœ€åé‚£ä¸ªå †é¡¶å…ƒç´ å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚æˆ‘ä»¬éœ€è¦ä¿è¯å †çš„å¤§å°ä¸º n, æˆ‘ä»¬åˆå§‹åŒ–å †çš„åˆå§‹ä¸º `[1]`, æ‰€ä»¥æˆ‘ä»¬å¾ªç¯ `n-1`æ¬¡ä¿è¯å †çš„å¤§å°ï¼Œæˆ‘ä»¬ç”¨å¤§é¡¶å †æ¥æœ€åå–å‡ºå †é¡¶å…ƒç´ å³å¯ã€‚

```python
class Solution:
    def nthUglyNumber(self, n: int) -> int:
        seen = {1}
        heap = [1]
        factors = (2, 3, 5)
        for _ in range(n - 1):
            cur = heapq.heappop(heap)
            for factor in factors:
                if (tmp := cur * factor) not in seen:
                    seen.add(tmp)
                    heapq.heappush(heap, tmp)
                    
        return heapq.heappop(heap)
```

